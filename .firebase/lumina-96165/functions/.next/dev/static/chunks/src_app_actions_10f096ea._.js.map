{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///Users/chepuriharikiran/Desktop/github/lumina-ai-learning/src/app/actions/data.ts"],"sourcesContent":["'use server';\n\nimport clientPromise from '@/lib/mongodb';\nimport { ObjectId } from 'mongodb';\n\nconst DB_NAME = 'test';\n\n// --- Student Actions ---\n\nexport async function getStudentDashboard(email: string) {\n    try {\n        const client = await clientPromise;\n        const db = client.db(DB_NAME);\n\n        // Get User\n        const user = await db.collection('users').findOne({ email });\n        if (!user) return null;\n\n        // Get Enrolled Courses (via Progress)\n        const progressDocs = await db.collection('progress').find({ userId: user._id }).toArray();\n\n        // Calculate Streak (Max streak from progress)\n        const currentStreak = progressDocs.reduce((acc, curr) => Math.max(acc, curr.streak || 0), 0);\n\n        // Calculate Overall Mastery\n        const avgMastery = progressDocs.length > 0\n            ? Math.round(progressDocs.reduce((acc, curr) => acc + (curr.mastery || 0), 0) / progressDocs.length)\n            : 0;\n\n        return {\n            currentStreak,\n            enrolledCourses: progressDocs, // We need to hydrate this with course details\n            overallMastery: avgMastery,\n            recentActivity: [] // Mock for now or implement activity log\n        };\n    } catch (e) {\n        console.error('Error fetching student dashboard:', e);\n        return null;\n    }\n}\n\nexport async function getEnrolledCourses(email: string) {\n    try {\n        const client = await clientPromise;\n        const db = client.db(DB_NAME);\n\n        const user = await db.collection('users').findOne({ email });\n        if (!user) return [];\n\n        // Aggregate Progress with Course Details\n        const courses = await db.collection('progress').aggregate([\n            { $match: { userId: user._id } },\n            {\n                $lookup: {\n                    from: 'courses',\n                    let: { courseId: '$courseId' },\n                    pipeline: [\n                        { $match: { $expr: { $eq: ['$id', '$$courseId'] } } }\n                    ],\n                    as: 'courseDetails'\n                }\n            },\n            { $unwind: '$courseDetails' },\n            {\n                $project: {\n                    id: '$courseDetails.id',\n                    name: '$courseDetails.name',\n                    description: '$courseDetails.description',\n                    thumbnail: '$courseDetails.thumbnail',\n                    progress: '$progress',\n                    mastery: '$mastery',\n                    streak: '$streak',\n                    lastAccessed: '$lastAccessed'\n                }\n            }\n        ]).toArray();\n\n        return courses;\n\n    } catch (e) {\n        console.error('Error fetching enrolled courses:', e);\n        return [];\n    }\n}\n\n// --- Community Actions ---\n\nexport async function getCommunityData(channelId: string = 'general') {\n    try {\n        const client = await clientPromise;\n        const db = client.db(DB_NAME);\n\n        // Get Channels\n        const channels = await db.collection('community_channels').find({}).toArray();\n\n        // Get Messages for active channel\n        const messages = await db.collection('community_messages')\n            .find({ channelId })\n            .sort({ createdAt: 1 })\n            .limit(50)\n            .toArray();\n\n        // Transform _id to string for client\n        return {\n            channels: channels.map(c => ({ ...c, _id: c._id.toString() })),\n            messages: messages.map(m => ({ ...m, _id: m._id.toString() }))\n        };\n\n    } catch (e) {\n        console.error('Error fetching community data:', e);\n        return { channels: [], messages: [] };\n    }\n}\n\n// --- Teacher Actions ---\n\nexport async function getTeacherDashboard(email: string) {\n    try {\n        const client = await clientPromise;\n        const db = client.db(DB_NAME);\n\n        const user = await db.collection('users').findOne({ email });\n        if (!user) return null;\n\n        // Get Courses taught by this teacher\n        const courses = await db.collection('courses').find({ instructorId: user._id }).toArray();\n\n        // Calculate Total Students (Sum of enrolledCount)\n        const totalStudents = courses.reduce((acc, curr) => acc + (curr.enrolledCount || 0), 0);\n\n        return {\n            courses: courses.map(c => ({\n                id: c.id,\n                name: c.name,\n                enrolled: c.enrolledCount,\n                thumbnail: c.thumbnail\n            })),\n            totalStudents,\n            activeCourses: courses.length,\n            // Mock other stats for now\n            hoursTaught: 120,\n            avgRating: 4.8\n        };\n    } catch (e) {\n        console.error('Error fetching teacher dashboard:', e);\n        return null;\n    }\n}\n\n// --- Admin Actions ---\n\nexport async function getAdminDashboard(email: string) {\n    try {\n        const client = await clientPromise;\n        const db = client.db(DB_NAME);\n\n        const usersCount = await db.collection('users').countDocuments();\n        const coursesCount = await db.collection('courses').countDocuments();\n        // Mock revenue/system health\n        return {\n            totalUsers: usersCount,\n            totalCourses: coursesCount,\n            systemHealth: '98%',\n            revenue: '$12,450'\n        };\n    } catch (e) {\n        console.error('Error fetching admin dashboard:', e);\n        return null;\n    }\n}\n"],"names":[],"mappings":";;;;;;;IASsB,sBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA"}},
    {"offset": {"line": 33, "column": 0}, "map": {"version":3,"sources":["file:///Users/chepuriharikiran/Desktop/github/lumina-ai-learning/src/app/actions/data.ts"],"sourcesContent":["'use server';\n\nimport clientPromise from '@/lib/mongodb';\nimport { ObjectId } from 'mongodb';\n\nconst DB_NAME = 'test';\n\n// --- Student Actions ---\n\nexport async function getStudentDashboard(email: string) {\n    try {\n        const client = await clientPromise;\n        const db = client.db(DB_NAME);\n\n        // Get User\n        const user = await db.collection('users').findOne({ email });\n        if (!user) return null;\n\n        // Get Enrolled Courses (via Progress)\n        const progressDocs = await db.collection('progress').find({ userId: user._id }).toArray();\n\n        // Calculate Streak (Max streak from progress)\n        const currentStreak = progressDocs.reduce((acc, curr) => Math.max(acc, curr.streak || 0), 0);\n\n        // Calculate Overall Mastery\n        const avgMastery = progressDocs.length > 0\n            ? Math.round(progressDocs.reduce((acc, curr) => acc + (curr.mastery || 0), 0) / progressDocs.length)\n            : 0;\n\n        return {\n            currentStreak,\n            enrolledCourses: progressDocs, // We need to hydrate this with course details\n            overallMastery: avgMastery,\n            recentActivity: [] // Mock for now or implement activity log\n        };\n    } catch (e) {\n        console.error('Error fetching student dashboard:', e);\n        return null;\n    }\n}\n\nexport async function getEnrolledCourses(email: string) {\n    try {\n        const client = await clientPromise;\n        const db = client.db(DB_NAME);\n\n        const user = await db.collection('users').findOne({ email });\n        if (!user) return [];\n\n        // Aggregate Progress with Course Details\n        const courses = await db.collection('progress').aggregate([\n            { $match: { userId: user._id } },\n            {\n                $lookup: {\n                    from: 'courses',\n                    let: { courseId: '$courseId' },\n                    pipeline: [\n                        { $match: { $expr: { $eq: ['$id', '$$courseId'] } } }\n                    ],\n                    as: 'courseDetails'\n                }\n            },\n            { $unwind: '$courseDetails' },\n            {\n                $project: {\n                    id: '$courseDetails.id',\n                    name: '$courseDetails.name',\n                    description: '$courseDetails.description',\n                    thumbnail: '$courseDetails.thumbnail',\n                    progress: '$progress',\n                    mastery: '$mastery',\n                    streak: '$streak',\n                    lastAccessed: '$lastAccessed'\n                }\n            }\n        ]).toArray();\n\n        return courses;\n\n    } catch (e) {\n        console.error('Error fetching enrolled courses:', e);\n        return [];\n    }\n}\n\n// --- Community Actions ---\n\nexport async function getCommunityData(channelId: string = 'general') {\n    try {\n        const client = await clientPromise;\n        const db = client.db(DB_NAME);\n\n        // Get Channels\n        const channels = await db.collection('community_channels').find({}).toArray();\n\n        // Get Messages for active channel\n        const messages = await db.collection('community_messages')\n            .find({ channelId })\n            .sort({ createdAt: 1 })\n            .limit(50)\n            .toArray();\n\n        // Transform _id to string for client\n        return {\n            channels: channels.map(c => ({ ...c, _id: c._id.toString() })),\n            messages: messages.map(m => ({ ...m, _id: m._id.toString() }))\n        };\n\n    } catch (e) {\n        console.error('Error fetching community data:', e);\n        return { channels: [], messages: [] };\n    }\n}\n\n// --- Teacher Actions ---\n\nexport async function getTeacherDashboard(email: string) {\n    try {\n        const client = await clientPromise;\n        const db = client.db(DB_NAME);\n\n        const user = await db.collection('users').findOne({ email });\n        if (!user) return null;\n\n        // Get Courses taught by this teacher\n        const courses = await db.collection('courses').find({ instructorId: user._id }).toArray();\n\n        // Calculate Total Students (Sum of enrolledCount)\n        const totalStudents = courses.reduce((acc, curr) => acc + (curr.enrolledCount || 0), 0);\n\n        return {\n            courses: courses.map(c => ({\n                id: c.id,\n                name: c.name,\n                enrolled: c.enrolledCount,\n                thumbnail: c.thumbnail\n            })),\n            totalStudents,\n            activeCourses: courses.length,\n            // Mock other stats for now\n            hoursTaught: 120,\n            avgRating: 4.8\n        };\n    } catch (e) {\n        console.error('Error fetching teacher dashboard:', e);\n        return null;\n    }\n}\n\n// --- Admin Actions ---\n\nexport async function getAdminDashboard(email: string) {\n    try {\n        const client = await clientPromise;\n        const db = client.db(DB_NAME);\n\n        const usersCount = await db.collection('users').countDocuments();\n        const coursesCount = await db.collection('courses').countDocuments();\n        // Mock revenue/system health\n        return {\n            totalUsers: usersCount,\n            totalCourses: coursesCount,\n            systemHealth: '98%',\n            revenue: '$12,450'\n        };\n    } catch (e) {\n        console.error('Error fetching admin dashboard:', e);\n        return null;\n    }\n}\n"],"names":[],"mappings":";;;;;;;IAyCsB,qBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA"}},
    {"offset": {"line": 48, "column": 0}, "map": {"version":3,"sources":["file:///Users/chepuriharikiran/Desktop/github/lumina-ai-learning/src/app/actions/data.ts"],"sourcesContent":["'use server';\n\nimport clientPromise from '@/lib/mongodb';\nimport { ObjectId } from 'mongodb';\n\nconst DB_NAME = 'test';\n\n// --- Student Actions ---\n\nexport async function getStudentDashboard(email: string) {\n    try {\n        const client = await clientPromise;\n        const db = client.db(DB_NAME);\n\n        // Get User\n        const user = await db.collection('users').findOne({ email });\n        if (!user) return null;\n\n        // Get Enrolled Courses (via Progress)\n        const progressDocs = await db.collection('progress').find({ userId: user._id }).toArray();\n\n        // Calculate Streak (Max streak from progress)\n        const currentStreak = progressDocs.reduce((acc, curr) => Math.max(acc, curr.streak || 0), 0);\n\n        // Calculate Overall Mastery\n        const avgMastery = progressDocs.length > 0\n            ? Math.round(progressDocs.reduce((acc, curr) => acc + (curr.mastery || 0), 0) / progressDocs.length)\n            : 0;\n\n        return {\n            currentStreak,\n            enrolledCourses: progressDocs, // We need to hydrate this with course details\n            overallMastery: avgMastery,\n            recentActivity: [] // Mock for now or implement activity log\n        };\n    } catch (e) {\n        console.error('Error fetching student dashboard:', e);\n        return null;\n    }\n}\n\nexport async function getEnrolledCourses(email: string) {\n    try {\n        const client = await clientPromise;\n        const db = client.db(DB_NAME);\n\n        const user = await db.collection('users').findOne({ email });\n        if (!user) return [];\n\n        // Aggregate Progress with Course Details\n        const courses = await db.collection('progress').aggregate([\n            { $match: { userId: user._id } },\n            {\n                $lookup: {\n                    from: 'courses',\n                    let: { courseId: '$courseId' },\n                    pipeline: [\n                        { $match: { $expr: { $eq: ['$id', '$$courseId'] } } }\n                    ],\n                    as: 'courseDetails'\n                }\n            },\n            { $unwind: '$courseDetails' },\n            {\n                $project: {\n                    id: '$courseDetails.id',\n                    name: '$courseDetails.name',\n                    description: '$courseDetails.description',\n                    thumbnail: '$courseDetails.thumbnail',\n                    progress: '$progress',\n                    mastery: '$mastery',\n                    streak: '$streak',\n                    lastAccessed: '$lastAccessed'\n                }\n            }\n        ]).toArray();\n\n        return courses;\n\n    } catch (e) {\n        console.error('Error fetching enrolled courses:', e);\n        return [];\n    }\n}\n\n// --- Community Actions ---\n\nexport async function getCommunityData(channelId: string = 'general') {\n    try {\n        const client = await clientPromise;\n        const db = client.db(DB_NAME);\n\n        // Get Channels\n        const channels = await db.collection('community_channels').find({}).toArray();\n\n        // Get Messages for active channel\n        const messages = await db.collection('community_messages')\n            .find({ channelId })\n            .sort({ createdAt: 1 })\n            .limit(50)\n            .toArray();\n\n        // Transform _id to string for client\n        return {\n            channels: channels.map(c => ({ ...c, _id: c._id.toString() })),\n            messages: messages.map(m => ({ ...m, _id: m._id.toString() }))\n        };\n\n    } catch (e) {\n        console.error('Error fetching community data:', e);\n        return { channels: [], messages: [] };\n    }\n}\n\n// --- Teacher Actions ---\n\nexport async function getTeacherDashboard(email: string) {\n    try {\n        const client = await clientPromise;\n        const db = client.db(DB_NAME);\n\n        const user = await db.collection('users').findOne({ email });\n        if (!user) return null;\n\n        // Get Courses taught by this teacher\n        const courses = await db.collection('courses').find({ instructorId: user._id }).toArray();\n\n        // Calculate Total Students (Sum of enrolledCount)\n        const totalStudents = courses.reduce((acc, curr) => acc + (curr.enrolledCount || 0), 0);\n\n        return {\n            courses: courses.map(c => ({\n                id: c.id,\n                name: c.name,\n                enrolled: c.enrolledCount,\n                thumbnail: c.thumbnail\n            })),\n            totalStudents,\n            activeCourses: courses.length,\n            // Mock other stats for now\n            hoursTaught: 120,\n            avgRating: 4.8\n        };\n    } catch (e) {\n        console.error('Error fetching teacher dashboard:', e);\n        return null;\n    }\n}\n\n// --- Admin Actions ---\n\nexport async function getAdminDashboard(email: string) {\n    try {\n        const client = await clientPromise;\n        const db = client.db(DB_NAME);\n\n        const usersCount = await db.collection('users').countDocuments();\n        const coursesCount = await db.collection('courses').countDocuments();\n        // Mock revenue/system health\n        return {\n            totalUsers: usersCount,\n            totalCourses: coursesCount,\n            systemHealth: '98%',\n            revenue: '$12,450'\n        };\n    } catch (e) {\n        console.error('Error fetching admin dashboard:', e);\n        return null;\n    }\n}\n"],"names":[],"mappings":";;;;;;;IAuFsB,mBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA"}},
    {"offset": {"line": 63, "column": 0}, "map": {"version":3,"sources":["file:///Users/chepuriharikiran/Desktop/github/lumina-ai-learning/src/app/actions/data.ts"],"sourcesContent":["'use server';\n\nimport clientPromise from '@/lib/mongodb';\nimport { ObjectId } from 'mongodb';\n\nconst DB_NAME = 'test';\n\n// --- Student Actions ---\n\nexport async function getStudentDashboard(email: string) {\n    try {\n        const client = await clientPromise;\n        const db = client.db(DB_NAME);\n\n        // Get User\n        const user = await db.collection('users').findOne({ email });\n        if (!user) return null;\n\n        // Get Enrolled Courses (via Progress)\n        const progressDocs = await db.collection('progress').find({ userId: user._id }).toArray();\n\n        // Calculate Streak (Max streak from progress)\n        const currentStreak = progressDocs.reduce((acc, curr) => Math.max(acc, curr.streak || 0), 0);\n\n        // Calculate Overall Mastery\n        const avgMastery = progressDocs.length > 0\n            ? Math.round(progressDocs.reduce((acc, curr) => acc + (curr.mastery || 0), 0) / progressDocs.length)\n            : 0;\n\n        return {\n            currentStreak,\n            enrolledCourses: progressDocs, // We need to hydrate this with course details\n            overallMastery: avgMastery,\n            recentActivity: [] // Mock for now or implement activity log\n        };\n    } catch (e) {\n        console.error('Error fetching student dashboard:', e);\n        return null;\n    }\n}\n\nexport async function getEnrolledCourses(email: string) {\n    try {\n        const client = await clientPromise;\n        const db = client.db(DB_NAME);\n\n        const user = await db.collection('users').findOne({ email });\n        if (!user) return [];\n\n        // Aggregate Progress with Course Details\n        const courses = await db.collection('progress').aggregate([\n            { $match: { userId: user._id } },\n            {\n                $lookup: {\n                    from: 'courses',\n                    let: { courseId: '$courseId' },\n                    pipeline: [\n                        { $match: { $expr: { $eq: ['$id', '$$courseId'] } } }\n                    ],\n                    as: 'courseDetails'\n                }\n            },\n            { $unwind: '$courseDetails' },\n            {\n                $project: {\n                    id: '$courseDetails.id',\n                    name: '$courseDetails.name',\n                    description: '$courseDetails.description',\n                    thumbnail: '$courseDetails.thumbnail',\n                    progress: '$progress',\n                    mastery: '$mastery',\n                    streak: '$streak',\n                    lastAccessed: '$lastAccessed'\n                }\n            }\n        ]).toArray();\n\n        return courses;\n\n    } catch (e) {\n        console.error('Error fetching enrolled courses:', e);\n        return [];\n    }\n}\n\n// --- Community Actions ---\n\nexport async function getCommunityData(channelId: string = 'general') {\n    try {\n        const client = await clientPromise;\n        const db = client.db(DB_NAME);\n\n        // Get Channels\n        const channels = await db.collection('community_channels').find({}).toArray();\n\n        // Get Messages for active channel\n        const messages = await db.collection('community_messages')\n            .find({ channelId })\n            .sort({ createdAt: 1 })\n            .limit(50)\n            .toArray();\n\n        // Transform _id to string for client\n        return {\n            channels: channels.map(c => ({ ...c, _id: c._id.toString() })),\n            messages: messages.map(m => ({ ...m, _id: m._id.toString() }))\n        };\n\n    } catch (e) {\n        console.error('Error fetching community data:', e);\n        return { channels: [], messages: [] };\n    }\n}\n\n// --- Teacher Actions ---\n\nexport async function getTeacherDashboard(email: string) {\n    try {\n        const client = await clientPromise;\n        const db = client.db(DB_NAME);\n\n        const user = await db.collection('users').findOne({ email });\n        if (!user) return null;\n\n        // Get Courses taught by this teacher\n        const courses = await db.collection('courses').find({ instructorId: user._id }).toArray();\n\n        // Calculate Total Students (Sum of enrolledCount)\n        const totalStudents = courses.reduce((acc, curr) => acc + (curr.enrolledCount || 0), 0);\n\n        return {\n            courses: courses.map(c => ({\n                id: c.id,\n                name: c.name,\n                enrolled: c.enrolledCount,\n                thumbnail: c.thumbnail\n            })),\n            totalStudents,\n            activeCourses: courses.length,\n            // Mock other stats for now\n            hoursTaught: 120,\n            avgRating: 4.8\n        };\n    } catch (e) {\n        console.error('Error fetching teacher dashboard:', e);\n        return null;\n    }\n}\n\n// --- Admin Actions ---\n\nexport async function getAdminDashboard(email: string) {\n    try {\n        const client = await clientPromise;\n        const db = client.db(DB_NAME);\n\n        const usersCount = await db.collection('users').countDocuments();\n        const coursesCount = await db.collection('courses').countDocuments();\n        // Mock revenue/system health\n        return {\n            totalUsers: usersCount,\n            totalCourses: coursesCount,\n            systemHealth: '98%',\n            revenue: '$12,450'\n        };\n    } catch (e) {\n        console.error('Error fetching admin dashboard:', e);\n        return null;\n    }\n}\n"],"names":[],"mappings":";;;;;;;IAoHsB,sBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA"}},
    {"offset": {"line": 78, "column": 0}, "map": {"version":3,"sources":["file:///Users/chepuriharikiran/Desktop/github/lumina-ai-learning/src/app/actions/data.ts"],"sourcesContent":["'use server';\n\nimport clientPromise from '@/lib/mongodb';\nimport { ObjectId } from 'mongodb';\n\nconst DB_NAME = 'test';\n\n// --- Student Actions ---\n\nexport async function getStudentDashboard(email: string) {\n    try {\n        const client = await clientPromise;\n        const db = client.db(DB_NAME);\n\n        // Get User\n        const user = await db.collection('users').findOne({ email });\n        if (!user) return null;\n\n        // Get Enrolled Courses (via Progress)\n        const progressDocs = await db.collection('progress').find({ userId: user._id }).toArray();\n\n        // Calculate Streak (Max streak from progress)\n        const currentStreak = progressDocs.reduce((acc, curr) => Math.max(acc, curr.streak || 0), 0);\n\n        // Calculate Overall Mastery\n        const avgMastery = progressDocs.length > 0\n            ? Math.round(progressDocs.reduce((acc, curr) => acc + (curr.mastery || 0), 0) / progressDocs.length)\n            : 0;\n\n        return {\n            currentStreak,\n            enrolledCourses: progressDocs, // We need to hydrate this with course details\n            overallMastery: avgMastery,\n            recentActivity: [] // Mock for now or implement activity log\n        };\n    } catch (e) {\n        console.error('Error fetching student dashboard:', e);\n        return null;\n    }\n}\n\nexport async function getEnrolledCourses(email: string) {\n    try {\n        const client = await clientPromise;\n        const db = client.db(DB_NAME);\n\n        const user = await db.collection('users').findOne({ email });\n        if (!user) return [];\n\n        // Aggregate Progress with Course Details\n        const courses = await db.collection('progress').aggregate([\n            { $match: { userId: user._id } },\n            {\n                $lookup: {\n                    from: 'courses',\n                    let: { courseId: '$courseId' },\n                    pipeline: [\n                        { $match: { $expr: { $eq: ['$id', '$$courseId'] } } }\n                    ],\n                    as: 'courseDetails'\n                }\n            },\n            { $unwind: '$courseDetails' },\n            {\n                $project: {\n                    id: '$courseDetails.id',\n                    name: '$courseDetails.name',\n                    description: '$courseDetails.description',\n                    thumbnail: '$courseDetails.thumbnail',\n                    progress: '$progress',\n                    mastery: '$mastery',\n                    streak: '$streak',\n                    lastAccessed: '$lastAccessed'\n                }\n            }\n        ]).toArray();\n\n        return courses;\n\n    } catch (e) {\n        console.error('Error fetching enrolled courses:', e);\n        return [];\n    }\n}\n\n// --- Community Actions ---\n\nexport async function getCommunityData(channelId: string = 'general') {\n    try {\n        const client = await clientPromise;\n        const db = client.db(DB_NAME);\n\n        // Get Channels\n        const channels = await db.collection('community_channels').find({}).toArray();\n\n        // Get Messages for active channel\n        const messages = await db.collection('community_messages')\n            .find({ channelId })\n            .sort({ createdAt: 1 })\n            .limit(50)\n            .toArray();\n\n        // Transform _id to string for client\n        return {\n            channels: channels.map(c => ({ ...c, _id: c._id.toString() })),\n            messages: messages.map(m => ({ ...m, _id: m._id.toString() }))\n        };\n\n    } catch (e) {\n        console.error('Error fetching community data:', e);\n        return { channels: [], messages: [] };\n    }\n}\n\n// --- Teacher Actions ---\n\nexport async function getTeacherDashboard(email: string) {\n    try {\n        const client = await clientPromise;\n        const db = client.db(DB_NAME);\n\n        const user = await db.collection('users').findOne({ email });\n        if (!user) return null;\n\n        // Get Courses taught by this teacher\n        const courses = await db.collection('courses').find({ instructorId: user._id }).toArray();\n\n        // Calculate Total Students (Sum of enrolledCount)\n        const totalStudents = courses.reduce((acc, curr) => acc + (curr.enrolledCount || 0), 0);\n\n        return {\n            courses: courses.map(c => ({\n                id: c.id,\n                name: c.name,\n                enrolled: c.enrolledCount,\n                thumbnail: c.thumbnail\n            })),\n            totalStudents,\n            activeCourses: courses.length,\n            // Mock other stats for now\n            hoursTaught: 120,\n            avgRating: 4.8\n        };\n    } catch (e) {\n        console.error('Error fetching teacher dashboard:', e);\n        return null;\n    }\n}\n\n// --- Admin Actions ---\n\nexport async function getAdminDashboard(email: string) {\n    try {\n        const client = await clientPromise;\n        const db = client.db(DB_NAME);\n\n        const usersCount = await db.collection('users').countDocuments();\n        const coursesCount = await db.collection('courses').countDocuments();\n        // Mock revenue/system health\n        return {\n            totalUsers: usersCount,\n            totalCourses: coursesCount,\n            systemHealth: '98%',\n            revenue: '$12,450'\n        };\n    } catch (e) {\n        console.error('Error fetching admin dashboard:', e);\n        return null;\n    }\n}\n"],"names":[],"mappings":";;;;;;;IAuJsB,oBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA"}}]
}